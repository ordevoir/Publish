Барицентрические координаты – это система координат, связанная с некоторым треугольником, которая позволяет представить любую точку на плоскости, в которой лежит треугольник, как линейную комбинацию вершин треугольника, при котором сумма коэффициентов равна 1.

Пусть $C$, $D$, $E$ – вершины треугольника на некоторой плоскости. Тогда, любая точка $P$ этой плоскости может быть представлена как

$$
P = αC+βD+γE, \quad  \text{где} \quad α+β+γ = 1.
$$

$α$, $β$ и $γ$ являются барицентрическими координатами точки $P$ относительно треугольника $CDE$. 

>[!detail]- 
> Всякий вектор на плоскости можно представить в виде линейной комбинации двух линейно независимых ненулевых векторов: $\mathbf{v} = λ_1 \mathbf{v}_1 + λ_2 \mathbf{v}_2$. В барицентрических координатах вектор на плоскости выражается через комбинацию трех линейно независимых векторов, поэтому определенному вектору соответствует не единственная система $α,β,γ$. Поэтому, можно наложить дополнительное условие – равенство суммы единице, и тем самым обеспечить единственность барицентрических координат $α,β,γ$ точки.
> 
> Если одна из вершин, скажем, $C$, треугольника совпадает с нулевым вектором $\mathbf{0}$ пространства (или заданным началом координат в [[Affine Space|аффинном пространстве]]), то произвольная точка будет выражена просто как линейная комбинация двух других координат:
> 
> $$
> P = βD+γE.
> $$
> 
> При этом, условие $α+β+γ = 1$ может быть выполнено при любых значениях $β$ и $γ$, так как значение $α$ может быть выбрано любым. Таким образом, условие будет выполнено при $α = 1 - β - γ$. 

# Свойства

Важным свойством барицентрических координат является по отношению к [[Affine Mapping|аффинным преобразованиям]]. Если задана пара – треугольник и некоторая точка, то барицентрические координаты точки по отношению к треугольнику будут такими же для любой другой пары треугольник-точка, которые могут быть получены из заданной пары путем аффинных преобразований. 
- Если все координаты положительны, $P$ лежит внутри треугольника.
- Если одна координата равна нулю, $P$ находится на стороне треугольника.
- Если две координаты нулевые, $P$ совпадает с вершиной.
- Отрицательные значения указывают на положение вне треугольника.

# Вычисление

Если известны координаты вершин треугольника $CDE$ и точки $P$, то барицентрические координаты $α,β,γ$  могут быть получены из решения системы линейных уравнений

$$
\begin{cases} 
x_P = α x_C + β x_D + γ x_E, \\[1.5mm]
y_P = α y_C + β y_D + γ y_E, \\[1.5mm]
α + β + γ = 1. 
\end{cases}
$$

Другой способ – вычислить барицентрические координаты через соотношения площадей треугольников:

$$
\alpha = \frac{S_{PDE}}{S_{CDE}}, \quad \beta = \frac{S_{CPE}}{S_{CDE}}, \quad \gamma = \frac{S_{CDP}}{S_{CDE}}.
$$

Аффинные преобразования меняют площади всех этих треугольников одинаково, поэтому их соотношения остаются неизменными.

# Пример

Вычислим барицентрические координаты точки $P$ по отношению к треугольнику $CDE$. Рассмотрим систему координат, в которой точка $C$ является началом координат, т.е. вершину $C$ треугольника мы выбираем в качестве опорной точки (*pivot*). Точка $P$ в исходной системе координат может быть выражена как

$$
P = C + β(D-C) + γ(E-C)
$$
![[barycentric_coords.png|hsmall center]]
Точка $C$ в этой системе координат служит нулевым вектором $\mathbf{0}$. 


Относительно плоскости треугольника с началом координат в точке $C$ и базисами $\mathbf{v}_D = D-C$ и $\mathbf{v}_E = E-C$ точке $P$ будет соответствовать вектор 

$$
\mathbf{v}_P = β \mathbf{v_D} + γ\mathbf{v}_E
$$

Коэффициенты $β$ и $γ$ при вершинах $D$ и $E$ являются барицентрическими координатами, а координата $α$ при вершине $C$ будет определена из уравнения $α+β+γ=1$.  

Найти коэффициенты $β$ и $γ$ можно спроецировав векторы $\mathbf{v}_P$ на базисные векторы $\mathbf{v}_D$ и $\mathbf{v}_E$. Получим проекции через скалярные произведения $\mathbf{v}_P \mathbf{v}_D$  и $\mathbf{v}_P \mathbf{v}_E$ :

$$
\begin{cases}
\mathbf{v}_P \mathbf{v}_D = β · v_D^2 + γ · \mathbf{v}_E \mathbf{v}_D  \\[1.5mm]
\mathbf{v}_P \mathbf{v}_E = β·\mathbf{v}_D \mathbf{v}_E + γ· v_E^2 \\[1.5mm]
α+β+γ=1
\end{cases}
$$

Решая эту систему уравнений, получаем барицентрические координаты:

$$
β = \frac{v_E^2 · \mathbf{v}_P \mathbf{v}_D - \mathbf{v}_E \mathbf{v}_D ·\mathbf{v}_P \mathbf{v}_E }{v_D^2 ·v_E^2 - (\mathbf{v}_E \mathbf{v}_D)^2} 
$$

$$
γ = \frac{v_D^2 · \mathbf{v}_P \mathbf{v}_E - \mathbf{v}_E \mathbf{v}_D ·\mathbf{v}_P \mathbf{v}_D }{v_D^2 ·v_E^2 - (\mathbf{v}_E \mathbf{v}_D)^2} 
$$

$$
α = 1 - β - γ
$$











