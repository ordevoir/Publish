
![[line_segment_intersection.png]]

>[!warning]- Отрицательный знак при $φ$
>Здесь угол $φ$ носит за собой знак $-$. Это связанно с тем, что угол на данном графике измеряется по часовой стрелке от оси $X$. В общем случае, лучше отмерять угол против часовой стрелки, тогда мы получили бы угол $ψ = 2π-φ$ и единичный вектор можно было бы записать $\mathbf{e} = \mathbf{i} \cos ψ + \mathbf{j} \sinψ$

Для нахождения точки пересечения между прямыми, отрезками или лучами, можно воспользоваться параметрическими уравнениями соответствующих прямых. Пусть имеется прямая, заданная единичным вектором $\mathbf{e}$ и точкой $A$, и прямая, заданная парой точек $C$ и $D$. 

Параметрическое уравнение прямой, заданной вектором $\mathbf{e}$ и точкой $A$:

$$
\begin{cases}
x = A_x + t e_x = A_x + t \cos (-φ) \\[1mm]
y = A_y + t e_y = A_y + t \sin (-φ) \\
\end{cases}
$$

Параметрическое уравнение прямой, заданной парой точек $С$, $D$:

$$
\begin{cases}
x = C_x + λ(D_x - C_x) \\[1mm]
y = C_y + λ(D_y - C_y) \\
\end{cases}
$$

Система уравнений

$$
\begin{cases}
C_x + λ(D_x - C_x) = A_x + t \cos (-φ) \\[1mm]
C_y + λ(D_y - C_y) = A_y + t \sin (-φ) \\
\end{cases}
$$

имеет решение

$$
\boxed{
\begin{aligned}
\lambda &= \frac{(A_x - C_x)\sin(-φ) - (A_y - C_y)\cos(-φ)}{(D_x - C_x)\sin(-φ) - (D_y - C_y)\cos(-φ)},\\[2mm]
t &= \frac{(D_x - C_x)(A_y - C_y) - (D_y - C_y)(A_x - C_x)}{(D_x - C_x)\sin(-φ) - (D_y - C_y)\cos(-φ)}.
\end{aligned}
}
$$

Если система не имеет решений, то это говорит о том, что прямые не пересекаются. Если прямые совпадают, то решение не будет единственным. Если $λ∈[0,1]$, то первая прямая пересекает отрезок $CD$. Знак параметра $t$ указывает, с каким лучом, исходящим из точки $A$, производится пересечение со второй прямой. Так как прямая строится при помощи единичного луча, то абсолютное значение $t$ равно расстоянию от точки $A$ до точки пересечения.


