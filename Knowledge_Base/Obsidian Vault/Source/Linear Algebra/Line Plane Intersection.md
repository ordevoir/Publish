![[line_plane_intersection.png|hsmall center]]

Пусть прямая задана точкой $A$ и вектором $\mathbf{v}$. Параметрическое уравнение прямой

$$
\mathbf{r}(t) = A + t·\mathbf{v} \tag 1
$$

Плоскость, в которой лежит треугольник $CDE$ может быть определена точкой $C$ и нормалью плоскости, которая может быть получена в результате векторного произведения двух векторов $\mathbf{p}$ и $\mathbf{q}$.

$$
\mathbf{n} = \mathbf{p} × \mathbf{q} = (D- C) × (E - C)
$$

>[!detail]- Направление нормали
Направление нормали $\mathbf{n}$ в данном случае определяется по правилу правого винта направлением обхода точек треугольника $CDE$ . Если бы мы обходили точки треугольника в направлении $CED$, то для того, чтобы вектор $\mathbf{n}$ был направлен в соответствующую сторону, нужно было бы поменять порядок векторов в произведении: $\mathbf{n} = \mathbf{q} × \mathbf{p}$. 

Уравнение плоскости можно записать так

$$
\mathbf{n} (\mathbf{r} - C) = 0
$$
>[!detail]- Общее уравнение плоскости
> Можно получить общее уравнение плоскости
> 
> $$
> \mathbf{n} \mathbf{r} - \mathbf{n}C = 0  \tag 2
> $$
> 
> В скалярной форме это можно записать так:
> 
> $$
> n_x x + n_y y + n_z z + d = 0
> $$
> 
> где $d = -n_xC_x - n_yC_y - n_zCz$.

Подставляя $(1)$ в $(2)$ получим решение

$$
t = \frac{\mathbf{n}(C-A)}{\mathbf{nv}} 
$$


>[!tip] 
Для того, чтобы выяснить, попадает ли точка пересечения внутрь треугольника $CDE$, лежит снаружи, или же на стороне или вершине, можно вычислить [[Barycentric Coordinates|барицентрические координаты]].


# Особые случаи

В силу того, что есть возможность обращения знаменателя в 0, следует рассмотреть **особые случаи**:
- если $\mathbf{nv} = 0$ и $\mathbf{n}(A-C)=0$, то прямая лежит в плоскости;
- если $\mathbf{nv} = 0$ и $\mathbf{n}(A-C)≠0$, то прямая параллельна плоскости, но не лежит на ней.

# Сторона плоскости, обращенная к точке A

Для того, чтобы определить, смотрит ли плоскость нормалью в полупространство, в котором находится точка $A$ или нет, достаточно посмотреть на знак скалярного произведения $\mathbf{n}(A-C)$. Здесь $A-C$ – вектор, направленный от точки $C$ к точке $A$. Поэтому, если $\mathbf{n}(A-C)>0$, то плоскость ориентирована "лицом" к точек $A$.

# Какой луч пересекает плоскость

Знак $t$ показывает, с каким лучом пересекается плоскость. Если $t>0$, то прямая пересекает плоскость в положительном луче, т.е. в положительном направлении вектора $\mathbf{v}$. Если же $t<0$, то пересечение с плоскостью производится в отрицательном луче. 

Если нас интересует пересечение с плоскостью только в положительном направлении вектора $\mathbf{v}$, т.е. только для $t>0$, то для того, чтобы выяснить (в случае наличия такого пересечения), смотрит ли нормаль в полупространство с точкой $A$, можно посмотреть на знак скалярного произведения $\mathbf{nv}$.  Если $\mathbf{nv}<0$, то плоскость ориентирована "лицом" к точек $A$. Следует иметь в виду, что в общем случае, когда мы рассматриваем и отрицательные $t$, $\mathbf{nv}<0$ будет иметь место если и $t<0$ и нормаль смотрит в противоположную сторону.

